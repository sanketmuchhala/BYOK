<!DOCTYPE html>
<html>
<head>
    <title>Fix BYOK Storage</title>
</head>
<body>
    <h1>BYOK Research Copilot - Storage Fixer</h1>
    <button onclick="clearStorage()">Clear All Storage</button>
    <button onclick="fixStorage()">Fix Storage with Valid Models</button>
    <pre id="output"></pre>
    
    <script>
        function log(msg) {
            document.getElementById('output').textContent += msg + '\n';
        }
        
        function clearStorage() {
            localStorage.removeItem('byok-api-keys');
            localStorage.removeItem('byok-settings');
            log('✅ Cleared all BYOK storage');
            showStorage();
        }
        
        function fixStorage() {
            // Set valid model names and clear invalid data
            const validSettings = {
                web_enabled: false,
                mode: 'direct',
                temperature: 0.7,
                max_tokens: 4000,
                selectedProvider: 'deepseek',
                selectedModel: 'deepseek-chat'
            };
            
            const validKeys = {
                modelName: 'deepseek-chat',
                apiKey: '' // User needs to set their own key
            };
            
            localStorage.setItem('byok-settings', JSON.stringify(validSettings));
            localStorage.setItem('byok-api-keys', JSON.stringify(validKeys));
            
            log('✅ Fixed storage with valid DeepSeek model name');
            log('⚠️ You still need to set your DeepSeek API key in settings');
            showStorage();
        }
        
        function showStorage() {
            log('\nCurrent storage:');
            log('Settings: ' + localStorage.getItem('byok-settings'));
            log('Keys: ' + localStorage.getItem('byok-api-keys'));
        }
        
        // Show current storage on load
        showStorage();
    </script>
</body>
</html>